<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Polinvent Signature Builder</title>
</head>

<body style="margin:0; padding:24px; background:#ffffff; font-family: Calibri, Arial, Helvetica, sans-serif; color:#000000;">
  <div style="max-width: 900px;">

    <div style="font-size:16pt; font-weight:700; margin:0 0 10px 0;">Polinvent email aláírás generátor</div>
    <div style="font-size:11pt; color:#555555; margin:0 0 18px 0;">
      Töltsd ki az adatokat, kattints a <strong>Generálás</strong> gombra, majd <strong>Aláírás másolása</strong>.
    </div>

    <!-- FORM -->
    <table cellpadding="0" cellspacing="0" border="0" style="margin:0 0 14px 0;">
      <tr>
        <td style="padding:0 14px 10px 0;">
          <div style="font-size:11pt; margin:0 0 4px 0;">Név</div>
          <input id="inpName" type="text" value="John Doe"
                 style="width:320px; padding:8px; font-size:11pt; font-family:inherit;">
        </td>

        <td style="padding:0 0 10px 0;">
          <div style="font-size:11pt; margin:0 0 4px 0;">Pozíció</div>
          <input id="inpTitle" type="text" value="Head of Operations"
                 style="width:320px; padding:8px; font-size:11pt; font-family:inherit;">
        </td>
      </tr>

      <tr>
        <td style="padding:0 14px 10px 0;">
          <div style="font-size:11pt; margin:0 0 4px 0;">Email</div>
          <input id="inpEmail" type="email" value="john.doe@polinvent.com"
                 style="width:320px; padding:8px; font-size:11pt; font-family:inherit;">
        </td>

        <td style="padding:0 0 10px 0;">
          <div style="font-size:11pt; margin:0 0 4px 0;">Telefonszám (nem link)</div>
          <input id="inpPhone" type="text" value="+36 20 123 4567"
                 style="width:320px; padding:8px; font-size:11pt; font-family:inherit;">
        </td>
      </tr>
    </table>

    <div style="display:flex; gap:10px; align-items:center; margin:0 0 18px 0;">
      <button id="btnGenerate" style="padding:10px 14px; font-size:11pt; font-family:inherit; cursor:pointer;">
        Generálás
      </button>
      <button id="btnCopy" disabled
              style="padding:10px 14px; font-size:11pt; font-family:inherit; cursor:pointer;">
        Aláírás másolása
      </button>
      <span id="status" style="font-size:11pt; color:#2a7a2a;"></span>
    </div>

    <div style="font-size:11pt; color:#555555; margin:0 0 8px 0;">Előnézet:</div>

    <!-- OUTPUT -->
    <div id="outputWrap" style="padding:14px; border:1px solid #e6e6e6; display:inline-block;"></div>

  </div>

  <script>
    const ADDRESS = "H-2360 Gyál, Bánki Donát u. 22.";
    const WEBSITE_TEXT = "www.polinvent.com";
    const WEBSITE_URL = "https://www.polinvent.com";
    const POLINVENT_URL = "https://www.polinvent.com/";
    const WWETT_URL = "https://www.wwettshow.com/en/home.html";

    const LOGO_SRC = "polinvent_logo_2026.png";
    const BANNER_SRC = "polinvent_wwett2026_banner_new.png";

    const GREY = "#999999";

    const elName = document.getElementById("inpName");
    const elTitle = document.getElementById("inpTitle");
    const elEmail = document.getElementById("inpEmail");
    const elPhone = document.getElementById("inpPhone");

    const btnGenerate = document.getElementById("btnGenerate");
    const btnCopy = document.getElementById("btnCopy");
    const outputWrap = document.getElementById("outputWrap");
    const statusEl = document.getElementById("status");

    function esc(s) {
      return String(s || "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function outlookSafePhone(phone) {
      // break automatic phone detection (Outlook)
      return phone.replace(/ /g, '&#8203; ');
    }

    function renderSignatureHtml() {
      const name = esc(elName.value.trim());
      const title = esc(elTitle.value.trim());
      const email = esc(elEmail.value.trim());
      const phone = outlookSafePhone(esc(elPhone.value.trim()));

      const html = `
<table cellpadding="0" cellspacing="0" border="0"
       style="font-family: Calibri, Arial, Helvetica, sans-serif; color:#000000;">

  <tr>
    <td style="font-size:11pt; font-weight:700; padding:0;">${name}</td>
  </tr>

  <tr>
    <td style="font-size:11pt; font-weight:400; padding:0;">${title}</td>
  </tr>

  <tr>
    <td style="height:14px; font-size:1px; line-height:1px;">&nbsp;</td>
  </tr>

  <tr>
    <td style="padding:0;">
      <a href="${POLINVENT_URL}" target="_blank" style="text-decoration:none;">
        <img src="${LOGO_SRC}" height="35" alt="Polinvent"
             style="display:block; border:0; outline:none;">
      </a>
    </td>
  </tr>

  <tr>
    <td style="height:10px; font-size:1px; line-height:1px;">&nbsp;</td>
  </tr>

  <tr>
    <td style="font-size:10pt; color:${GREY}; padding:0;">
      <a href="mailto:${email}" style="color:${GREY}; text-decoration:none;">
        ${email}
      </a>
      &nbsp;|&nbsp;
      <span style="mso-no-proof:yes;">${phone}</span>
    </td>
  </tr>

  <tr>
    <td style="font-size:10pt; color:${GREY}; padding:0;">
      ${ADDRESS}
      &nbsp;|&nbsp;
      <a href="${WEBSITE_URL}" target="_blank" style="color:${GREY}; text-decoration:none;">
        ${WEBSITE_TEXT}
      </a>
    </td>
  </tr>

  <tr>
    <td style="height:20px; font-size:1px; line-height:1px;">&nbsp;</td>
  </tr>

  <tr>
    <td style="height:20px; font-size:1px; line-height:1px;">&nbsp;</td>
  </tr>

  <tr>
    <td style="padding:0;">
      <a href="${WWETT_URL}" target="_blank" style="text-decoration:none;">
        <img src="${BANNER_SRC}" height="76" alt="WWETT 2026"
             style="display:block; border:0; outline:none;">
      </a>
    </td>
  </tr>

</table>`.trim();

      return html;
    }

    function generate() {
      statusEl.textContent = "";
      outputWrap.innerHTML = renderSignatureHtml();
      btnCopy.disabled = false;
      statusEl.textContent = "Aláírás legenerálva.";
    }

    async function copyHtml() {
      statusEl.textContent = "";
      const html = renderSignatureHtml();
      outputWrap.innerHTML = html;

      try {
        if (navigator.clipboard && window.ClipboardItem) {
          const blob = new Blob([html], { type: "text/html" });
          await navigator.clipboard.write([new ClipboardItem({ "text/html": blob })]);
          statusEl.textContent = "Kimásolva. Illeszd be az Outlook aláírás szerkesztőbe.";
          return;
        }
      } catch {}

      const range = document.createRange();
      range.selectNodeContents(outputWrap);
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
      document.execCommand("copy");
      sel.removeAllRanges();

      statusEl.textContent = "Kimásolva (fallback). Illeszd be az Outlook aláírás szerkesztőbe.";
    }

    btnGenerate.addEventListener("click", generate);
    btnCopy.addEventListener("click", copyHtml);

    // auto-generate on load
    generate();
  </script>
</body>
</html>
