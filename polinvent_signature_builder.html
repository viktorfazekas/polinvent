<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Polinvent – Email aláírás generátor</title>
</head>

<body style="margin:0; padding:24px; background:#ffffff; font-family: Calibri, Arial, Helvetica, sans-serif; color:#000000;">
  <div style="max-width: 900px;">

    <div style="font-size:16pt; font-weight:700; margin:0 0 10px 0;">Polinvent email aláírás generátor</div>
    <div style="font-size:11pt; color:#555555; margin:0 0 18px 0;">
      Töltsd ki az adatokat, kattints a <strong>Generálás</strong> gombra, majd <strong>Aláírás másolása</strong>.
    </div>

    <!-- FORM -->
    <table cellpadding="0" cellspacing="0" border="0" style="margin:0 0 14px 0;">
      <tr>
        <td style="padding:0 14px 10px 0;">
          <div style="font-size:11pt; margin:0 0 4px 0;">Név</div>
          <input id="inpName" type="text" value="John Doe"
                 style="width:320px; padding:8px; font-size:11pt; font-family:inherit;">
        </td>

        <td style="padding:0 0 10px 0;">
          <div style="font-size:11pt; margin:0 0 4px 0;">Pozíció</div>
          <input id="inpTitle" type="text" value="Head of Operations"
                 style="width:320px; padding:8px; font-size:11pt; font-family:inherit;">
        </td>
      </tr>

      <tr>
        <td style="padding:0 14px 10px 0;">
          <div style="font-size:11pt; margin:0 0 4px 0;">Email</div>
          <input id="inpEmail" type="email" value="john.doe@polinvent.com"
                 style="width:320px; padding:8px; font-size:11pt; font-family:inherit;">
        </td>

        <td style="padding:0 0 10px 0;">
          <div style="font-size:11pt; margin:0 0 4px 0;">Telefonszám</div>
          <input id="inpPhone" type="text" value="+36 20 123 4567"
                 style="width:320px; padding:8px; font-size:11pt; font-family:inherit;">
        </td>
      </tr>
    </table>

    <div style="display:flex; gap:10px; align-items:center; margin:0 0 18px 0;">
      <button id="btnGenerate" style="padding:10px 14px; font-size:11pt; font-family:inherit; cursor:pointer;">
        Generálás
      </button>
      <button id="btnCopy" disabled
              style="padding:10px 14px; font-size:11pt; font-family:inherit; cursor:pointer;">
        Aláírás másolása
      </button>
      <span id="status" style="font-size:11pt; color:#2a7a2a;"></span>
    </div>

    <div style="font-size:11pt; color:#555555; margin:0 0 8px 0;">Előnézet:</div>

    <!-- OUTPUT -->
    <div id="outputWrap" style="padding:14px; border:1px solid #e6e6e6; display:inline-block;"></div>

  </div>

  <script>
    const ADDRESS = "H-2360 Gyál, Bánki Donát u. 22.";
    const WEBSITE_TEXT = "www.polinvent.com";
    const WEBSITE_URL = "https://www.polinvent.com";
    const POLINVENT_URL = "https://www.polinvent.com/";
    const WWETT_URL = "https://www.wwettshow.com/en/home.html";

    const LOGO_SRC = "https://viktorfazekas.github.io/polinvent/polinvent_logo_2026.png";
    const BANNER_SRC = "https://viktorfazekas.github.io/polinvent/polinvent_wwett2026_banner_new.png";

    const GREY = "#999999";

    const elName = document.getElementById("inpName");
    const elTitle = document.getElementById("inpTitle");
    const elEmail = document.getElementById("inpEmail");
    const elPhone = document.getElementById("inpPhone");

    const btnGenerate = document.getElementById("btnGenerate");
    const btnCopy = document.getElementById("btnCopy");
    const outputWrap = document.getElementById("outputWrap");
    const statusEl = document.getElementById("status");

    function esc(s) {
      return String(s || "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    // Normalize Hungarian phone numbers to display format: +36 20 361 9946
    // Supports inputs like: 06203619946, +36203619946, 0036203619946, 36 20 361 9946, 20 361 9946
    // If it doesn't match expected pattern, returns original trimmed input.
    function normalizeHuPhoneDisplay(raw) {
      let s = String(raw || "").trim();

      // remove common separators but keep intent
      s = s.replace(/[()\-.]/g, " ");

      // keep only digits and +
      s = s.replace(/[^\d+]/g, "");

      // 00 -> +
      if (s.startsWith("00")) s = "+" + s.slice(2);

      // remove leading + for parsing
      let digits = s.startsWith("+") ? s.slice(1) : s;
      digits = digits.replace(/\D/g, "");

      // strip country code 36 if present
      if (digits.startsWith("36")) digits = digits.slice(2);

      // strip trunk 06 if present (some users paste 06...)
      if (digits.startsWith("06")) digits = digits.slice(2);

      // Expect HU national number without prefixes:
      // - common mobile format: 9 digits (e.g. 20 + 7 digits)
      if (!/^\d{9}$/.test(digits)) return String(raw || "").trim();

      const provider = digits.slice(0, 2);
      const rest = digits.slice(2); // 7 digits
      const part1 = rest.slice(0, 3);
      const part2 = rest.slice(3, 7);

      return `+36 ${provider} ${part1} ${part2}`;
    }

    // tel: href should be + and digits only (no spaces)
    function normalizeHuPhoneForTel(displayPhone) {
      return String(displayPhone || "").replace(/[^\d+]/g, "");
    }

    function renderSignatureHtml() {
      const name = esc(elName.value.trim());
      const title = esc(elTitle.value.trim());
      const email = esc(elEmail.value.trim());

      const phoneDisplayRaw = normalizeHuPhoneDisplay(elPhone.value.trim());
      const phoneDisplay = esc(phoneDisplayRaw);
      const phoneHref = esc(normalizeHuPhoneForTel(phoneDisplayRaw));

      const html = `
<table cellpadding="0" cellspacing="0" border="0"
       style="font-family: Calibri, Arial, Helvetica, sans-serif; color:#000000;">

  <tr>
    <td style="font-size:11pt; font-weight:700; padding:0;">${name}</td>
  </tr>

  <tr>
    <td style="font-size:11pt; font-weight:400; padding:0;">${title}</td>
  </tr>

  <tr>
    <td style="height:14px; font-size:1px; line-height:1px;">&nbsp;</td>
  </tr>

  <tr>
    <td style="padding:0;">
      <a href="${POLINVENT_URL}" target="_blank" style="text-decoration:none;">
        <img src="${LOGO_SRC}" height="35" alt="Polinvent"
             style="display:block; border:0; outline:none;">
      </a>
    </td>
  </tr>

  <tr>
    <td style="height:10px; font-size:1px; line-height:1px;">&nbsp;</td>
  </tr>

  <tr>
    <td style="font-size:10pt; color:${GREY}; padding:0;">
      <a href="mailto:${email}" style="color:${GREY}; text-decoration:none;">
        ${email}
      </a>
      &nbsp;|&nbsp;
      <a href="tel:${phoneHref}" style="color:${GREY}; text-decoration:none;">
        ${phoneDisplay}
      </a>
    </td>
  </tr>

  <tr>
    <td style="font-size:10pt; color:${GREY}; padding:0;">
      ${ADDRESS}
      &nbsp;|&nbsp;
      <a href="${WEBSITE_URL}" target="_blank" style="color:${GREY}; text-decoration:none;">
        ${WEBSITE_TEXT}
      </a>
    </td>
  </tr>

  <tr>
    <td style="height:20px; font-size:1px; line-height:1px;">&nbsp;</td>
  </tr>

  <tr>
    <td style="height:20px; font-size:1px; line-height:1px;">&nbsp;</td>
  </tr>

  <tr>
    <td style="padding:0;">
      <a href="${WWETT_URL}" target="_blank" style="text-decoration:none;">
        <img src="${BANNER_SRC}" height="76" alt="WWETT 2026"
             style="display:block; border:0; outline:none;">
      </a>
    </td>
  </tr>

</table>`.trim();

      return html;
    }

    function generate() {
      statusEl.textContent = "";

      // Optional UX: normalize the phone field itself so users see the final format too
      const normalized = normalizeHuPhoneDisplay(elPhone.value.trim());
      elPhone.value = normalized;

      outputWrap.innerHTML = renderSignatureHtml();
      btnCopy.disabled = false;
      statusEl.textContent = "Aláírás legenerálva.";
    }

    async function copyHtml() {
      statusEl.textContent = "";
      const html = renderSignatureHtml();
      outputWrap.innerHTML = html;

      try {
        if (navigator.clipboard && window.ClipboardItem) {
          const blob = new Blob([html], { type: "text/html" });
          await navigator.clipboard.write([new ClipboardItem({ "text/html": blob })]);
          statusEl.textContent = "Kimásolva. Illeszd be az Outlook aláírás szerkesztőbe.";
          return;
        }
      } catch {}

      const range = document.createRange();
      range.selectNodeContents(outputWrap);
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
      document.execCommand("copy");
      sel.removeAllRanges();

      statusEl.textContent = "Kimásolva (fallback). Illeszd be az Outlook aláírás szerkesztőbe.";
    }

    btnGenerate.addEventListener("click", generate);
    btnCopy.addEventListener("click", copyHtml);

    // auto-generate on load
    generate();
  </script>
</body>
</html>
